!function(){document.querySelectorAll(".solicitudes").forEach(n=>{n.addEventListener("click",(function(o){e(n.querySelector(".id").innerHTML.trim(),"solicitudes")}))});document.querySelectorAll(".usuarios").forEach(n=>{n.addEventListener("click",(function(o){e(n.querySelector(".id").innerHTML.trim(),"usuarios")}))});function e(e,o){if(null!==e){var t=new FormData;t.append("id",e)}try{if("solicitudes"==o)var a="http://localhost:3001/dashboard";else if("usuarios"==o)a="http://localhost:3001/usuario";else if("agregar-Usuario"==o){return void n(function(){const e=document.createElement("DIV");return e.classList.add("modal"),e.innerHTML='\n        <form action="/usuarios" class="formulario">\n                <legend>AÃ±adir nuevo Usuario</legend>\n                <div class="campo">\n                    <label class="subtitulo">Usuario</label>\n                    <input\n                        type= "text"\n                        name = "usuario"\n                        placeholder="Ingresa el nombre de usuario"\n                        id="usuario"\n                    />\n                </div>\n                <div class="campo">\n                    <label class="subtitulo">Rol</label>\n                    <select id="rol">\n                        <option value="ninguno">--Selecciona un Rol--</option>\n                        <option value="docente">Docente</option>\n                        <option value="soporte">Soporte</option>\n                    </select>\n                </div>\n                <div class="campo">\n                    <label class="subtitulo">Password</label>\n                    <input\n                        type= "password"\n                        name = "psw"\n                        placeholder="Ingresa el password del usuario"\n                        id="psw"\n                    />\n                </div>\n                <div class="opciones">\n                    <input type="submit" class="submit-nuevo-usuario" value="Crear Usuario"/>\n                    <button type="button" class="cerrar-modal">Cancelar</button>\n                </div>\n            </form>\n    ',e}())}(async function(e,n){const o=await fetch(e,{method:"POST",body:n});return await o.json()})(a,t).then((function(e){if("soporte"==e.remitente)var o=function(e){if("terminado"===e.estado)var n="completa";else if("en_camino"===e.estado)n="camino";else n="pendiente";const o=document.createElement("DIV");o.classList.add("modal");var t="en_camino"===e.estado?"En Camino":e.estado;return o.innerHTML='\n        <form class="formulario"> \n            <div class="contenedor-titulo">\n            <legend class="">Solicitud '+t+' </legend> \n            <div class="imagen-estado '+n+'"></div>\n            </div>          \n            <div class="campo">\n                <label class="subtitulo" >Tipo:</label>\n                <label>'+e.tipo+'</label>\n            </div>\n            <div class="campo">\n                <label class="subtitulo">Bloque:</label>\n                <label>'+e.bloque+'</label>\n            </div>\n            <div class="campo">\n                <label class="subtitulo">Aula:</label>\n                <label>'+e.aula+'</label>\n            </div>\n            <div class="campo">\n                <label class="subtitulo">Usuario:</label>\n                <label>'+e.usuario+'</label>\n            </div>\n            <div class="campo">\n                <label class="subtitulo">Detalle:</label>\n                <label>'+e.detalle+'</label>\n            </div>                \n            <div class="opciones-unica">\n                <button type="button" class="cerrar-modal">Volver</button>\n            </div>\n        </form>\n    ',o}(e);else if("docente"==e.remitente)o=function(e){var n="",o="";"docente"==e.rol?n="selected":o="selected";const t=document.createElement("DIV");return t.classList.add("modal"),t.innerHTML='\n        <form class="formulario" >\n                <legend>Usuario: '+e.usuario+'</legend>\n                <div class="campo">\n                    <label class="subtitulo">Rol</label>\n                    <select id="rol">\n                        <option '+n+' value="docente">Docente</option>\n                        <option '+o+' value="soporte">Soporte</option>\n                    </select>\n                </div>\n                <div class="opciones">\n                    <input type="submit" class="submit-actualizar-usuario" value="Actualizar"/>\n                    <button type="button" class="cerrar-modal">Cancelar</button>\n                </div>\n            </form>\n    ',t}(e);n(o,e.id)}))}catch(e){console.log(e)}}function n(e,n=""){setTimeout(()=>{document.querySelector(".formulario").classList.add("animar")},100),e.addEventListener("click",(function(a){if(a.preventDefault(),a.target.classList.contains("cerrar-modal")){document.querySelector(".formulario").classList.add("cerrar"),setTimeout(()=>{e.remove()},500)}a.target.classList.contains("submit-actualizar-usuario")&&async function(e){var n={rol:""+document.querySelector("#rol").value.trim()},t=JSON.stringify(n);o("http://localhost:3000/usuarios/"+e,t,"PUT")}(n),a.target.classList.contains("submit-nuevo-usuario")&&function(){const e=document.querySelector("#rol").value.trim(),n=document.querySelector("#usuario").value.trim(),a=document.querySelector("#psw").value.trim();if(""==n||""==a)return void t("El usuario y el password no puede ir vacio","error",document.querySelector("legend"));if("ninguno"==e)return void t("Debe elegir un rol","error",document.querySelector("legend"));if(!/^[a-zA-Z]+$/.test(n))return void t("El usuario solo debe contener letras","error",document.querySelector("legend"));var l={rol:""+e,usuario:""+n,psw:""+a};o("http://localhost:3000/usuarios",JSON.stringify(l))}()})),document.querySelector(".dashboard").appendChild(e)}async function o(e,n,o="POST"){try{const t=await fetch(e,{method:o,headers:{"Content-Type":"application/json"},body:n}),a=await t.json();return"Updated"==a.message?alert("Actualizado"):"Saved"==a.message&&alert("Usuario Creado"),void location.reload()}catch(e){console.log(e)}}function t(e,n,o){const t=document.querySelector(".alerta");t&&t.remove();const a=document.createElement("DIV");a.classList.add("alerta",n),a.textContent=e,o.parentElement.insertBefore(a,o.nextElementSibling),setTimeout(()=>{a.remove()},5e3)}document.querySelector(".nuevoUser").addEventListener("click",(function(n){e(null,"agregar-Usuario")}))}();